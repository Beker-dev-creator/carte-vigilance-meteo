<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Radar Météo France</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
  <style>
    body { margin: 0; overflow: hidden; background: #000; }
    canvas { display: block; margin: auto; }
  </style>
</head>
<body>
<script>
  let mapImg;
  let blobs = [];

  function preload() {
    // ✅ Carte fiable sans problème CORS
    mapImg = loadImage("https://upload.wikimedia.org/wikipedia/commons/thumb/1/11/France_map_Lambert-93_with_departments.png/600px-France_map_Lambert-93_with_departments.png");
  }

  function setup() {
    createCanvas(600, 600);
    imageMode(CENTER);

    for (let i = 0; i < 60; i++) {
      blobs.push({
        x: random(150, 450),
        y: random(100, 500),
        dx: random(-0.8, 0.8),
        dy: random(-0.8, 0.8),
        size: random(10, 30),
        intensity: random(0, 100)
      });
    }
  }

  function draw() {
    background(255);
    image(mapImg, width / 2, height / 2, 600, 600);

    noStroke();
    for (let b of blobs) {
      fill(getColorFromIntensity(b.intensity));
      ellipse(b.x, b.y, b.size);

      b.x += b.dx;
      b.y += b.dy;

      if (b.x < 100 || b.x > 500) b.dx *= -1;
      if (b.y < 80 || b.y > 520) b.dy *= -1;
    }
  }

  function getColorFromIntensity(intensity) {
    if (intensity < 25) return color(100, 150, 255, 150);   // Bleu clair
    else if (intensity < 50) return color(0, 200, 0, 170);   // Vert
    else if (intensity < 75) return color(255, 200, 0, 180); // Jaune
    else return color(255, 0, 0, 190);                       // Rouge
  }
</script>
</body>
</html>
