<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Radar Météo France – Carte Simplifiée</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
  <style>
    body { margin: 0; overflow: hidden; background: #000; }
    canvas { display: block; margin: auto; }
  </style>
</head>
<body>
<script>
  let blobs = [];

  function setup() {
    createCanvas(600, 600);
    drawFranceMap(); // une seule fois au début
    imageMode(CENTER);

    // Création de précipitations aléatoires
    for (let i = 0; i < 60; i++) {
      blobs.push({
        x: random(150, 450),
        y: random(100, 500),
        dx: random(-0.8, 0.8),
        dy: random(-0.8, 0.8),
        size: random(10, 30),
        intensity: random(0, 100)
      });
    }
  }

  function draw() {
    background(255);
    drawFranceMap();

    noStroke();
    for (let b of blobs) {
      fill(getColorFromIntensity(b.intensity));
      ellipse(b.x, b.y, b.size);

      b.x += b.dx;
      b.y += b.dy;

      if (b.x < 100 || b.x > 500) b.dx *= -1;
      if (b.y < 80 || b.y > 520) b.dy *= -1;
    }
  }

  function drawFranceMap() {
    push();
    fill(230);
    stroke(100);
    strokeWeight(2);
    beginShape();
    // Contour stylisé de la France, simplifié
    vertex(300, 100);
    vertex(350, 120);
    vertex(370, 150);
    vertex(400, 180);
    vertex(420, 240);
    vertex(430, 300);
    vertex(420, 360);
    vertex(390, 420);
    vertex(370, 460);
    vertex(340, 500);
    vertex(300, 520);
    vertex(260, 500);
    vertex(230, 460);
    vertex(210, 420);
    vertex(180, 360);
    vertex(170, 300);
    vertex(180, 240);
    vertex(200, 180);
    vertex(230, 150);
    vertex(260, 120);
    endShape(CLOSE);
    pop();
  }

  function getColorFromIntensity(intensity) {
    if (intensity < 25) return color(100, 150, 255, 150);   // Bleu clair
    else if (intensity < 50) return color(0, 200, 0, 170);   // Vert
    else if (intensity < 75) return color(255, 200, 0, 180); // Jaune
    else return color(255, 0, 0, 190);                       // Rouge
  }
</script>
</body>
</html>
