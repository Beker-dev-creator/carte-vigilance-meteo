<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Carte de Vigilance Météo - Démo</title>
  <style>
    body { font-family: Arial, sans-serif; display: flex; margin: 0; padding: 0; }
    .carte { flex: 2; padding: 20px; background-color: #f9f9f9; }
    .controle { flex: 1; padding: 20px; background-color: #e5e5e5; max-width: 400px; }
    .btn { margin: 5px 5px 5px 0; padding: 10px; border: none; border-radius: 4px; cursor: pointer; color: white; }
    .vert { background-color: #47d147; }
    .jaune { background-color: #f7e347; color: #000; }
    .orange { background-color: #f7a347; }
    .rouge { background-color: #f75a47; }
    .evenement-btn { background-color: #39c; color: white; margin: 3px 3px 3px 0; padding: 6px 10px; border-radius: 4px; cursor: pointer; }
    .form-section { margin-top: 10px; }
    svg { width: 100%; height: auto; }
    .departement { stroke: #000; stroke-width: 0.5; cursor: pointer; transition: fill 0.3s; }
    .annotation { font-size: 12px; fill: black; text-anchor: middle; pointer-events: none; }
  </style>
</head>
<body>

<div class="carte">
  <svg id="france-map" viewBox="0 0 300 300">
    <!-- Départements exemple -->
    <path id="dept-01" class="departement" d="M100,100 L120,100 L120,120 L100,120 Z" fill="#47d147"></path>
    <path id="dept-02" class="departement" d="M130,100 L150,100 L150,120 L130,120 Z" fill="#47d147"></path>
    <path id="dept-03" class="departement" d="M100,130 L120,130 L120,150 L100,150 Z" fill="#47d147"></path>
  </svg>
</div>

<div class="controle">
  <h2>Vigilance météo</h2>

  <div class="form-section">
    <label>Événement :</label><br>
    <button class="evenement-btn" data-event="orage">ORAGE</button>
    <button class="evenement-btn" data-event="pluie">PLUIE</button>
    <button class="evenement-btn" data-event="vent">VENT</button>
    <button class="evenement-btn" data-event="neige">NEIGE</button>
  </div>

  <div class="form-section">
    <label>Couleur :</label><br>
    <button class="btn vert" data-color="#47d147">Vert</button>
    <button class="btn jaune" data-color="#f7e347">Jaune</button>
    <button class="btn orange" data-color="#f7a347">Orange</button>
    <button class="btn rouge" data-color="#f75a47">Rouge</button>
  </div>
</div>

<script>
  let couleurActuelle = "#47d147";
  let evenementActuel = "";

  document.querySelectorAll('.btn').forEach(btn => {
    btn.addEventListener('click', () => {
      couleurActuelle = btn.getAttribute('data-color');
    });
  });

  document.querySelectorAll('.evenement-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      evenementActuel = btn.getAttribute('data-event');
    });
  });

  document.querySelectorAll('.departement').forEach(dept => {
    dept.addEventListener('click', () => {
      dept.setAttribute('fill', couleurActuelle);

      const old = document.querySelector(`#annotation-${dept.id}`);
      if (old) old.remove();

      if (evenementActuel !== "") {
        const bbox = dept.getBBox();
        const svg = document.getElementById("france-map");

        const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
        text.setAttribute("x", bbox.x + bbox.width / 2);
        text.setAttribute("y", bbox.y + bbox.height / 2);
        text.setAttribute("class", "annotation");
        text.setAttribute("id", `annotation-${dept.id}`);
        text.textContent = evenementActuel.toUpperCase();
        svg.appendChild(text);
      }
    });
  });
</script>

</body>
</html>