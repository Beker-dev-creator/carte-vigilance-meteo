<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Carte Vigilance Météo</title>
  <style>
    .departement {
      cursor: pointer;
      transition: 0.2s;
    }
    .departement:hover {
      opacity: 0.7;
    }
    .active {
      stroke: black;
      stroke-width: 2;
    }
    .boutons {
      margin: 10px 0;
    }
    button {
      margin: 5px;
      padding: 6px 12px;
      font-size: 14px;
    }
    .icon {
      vertical-align: middle;
      margin-right: 6px;
    }
  </style>
</head>
<body>

<!-- Icônes SVG -->
<svg xmlns="http://www.w3.org/2000/svg" style="display:none;">
  <symbol id="icone-orage" viewBox="0 0 64 64">
    <path d="M32 4L24 32h8l-4 28 16-32h-8l8-24z" fill="#ffcc00"/>
  </symbol>
  <symbol id="icone-vent" viewBox="0 0 64 64">
    <path d="M10 20h44M10 32h34M10 44h24" stroke="#66ccff" stroke-width="6" stroke-linecap="round"/>
  </symbol>
</svg>

<!-- Boutons Couleur -->
<div class="boutons">
  <strong>Couleurs :</strong>
  <button class="couleur-btn" data-couleur="#32CD32">Vert</button>
  <button class="couleur-btn" data-couleur="#FFD700">Jaune</button>
  <button class="couleur-btn" data-couleur="#FF8C00">Orange</button>
  <button class="couleur-btn" data-couleur="#FF0000">Rouge</button>
</div>

<!-- Boutons Événements -->
<div class="boutons">
  <strong>Événements :</strong>
  <button class="event-btn" data-event="orage">
    <svg class="icon" width="20" height="20"><use href="#icone-orage"/></svg> Orage
  </button>
  <button class="event-btn" data-event="vent">
    <svg class="icon" width="20" height="20"><use href="#icone-vent"/></svg> Vent
  </button>
</div>

<!-- Carte de France (test avec 2 départements) -->
<svg id="carte" width="300" height="200" viewBox="0 0 100 100" style="border:1px solid #ccc;">
  <rect id="dep01" class="departement" x="10" y="10" width="30" height="30" fill="#ccc"/>
  <rect id="dep02" class="departement" x="60" y="10" width="30" height="30" fill="#ccc"/>
</svg>

<script>
  const evenements = {
    orage: "#icone-orage",
    vent: "#icone-vent"
  };

  let selection = null;

  // Sélectionner un département
  document.querySelectorAll('.departement').forEach(dep => {
    dep.addEventListener('click', () => {
      if (selection) selection.classList.remove('active');
      selection = dep;
      dep.classList.add('active');
    });
  });

  // Appliquer une couleur
  document.querySelectorAll('.couleur-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      if (!selection) return alert("Sélectionne un département !");
      selection.setAttribute('fill', btn.dataset.couleur);
    });
  });

  // Appliquer une icône météo
  document.querySelectorAll('.event-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      if (!selection) return alert("Sélectionne un département !");
      
      // Supprime l’ancienne icône
      let oldIcon = selection.querySelector('svg');
      if (oldIcon) oldIcon.remove();

      const symbole = evenements[btn.dataset.event];

      const use = document.createElementNS("http://www.w3.org/2000/svg", "use");
      use.setAttribute("href", symbole);

      const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
      svg.setAttribute("width", "20");
      svg.setAttribute("height", "20");
      svg.setAttribute("x", "5");
      svg.setAttribute("y", "5");
      svg.appendChild(use);

      selection.appendChild(svg);
    });
  });
</script>

</body>
</html>
